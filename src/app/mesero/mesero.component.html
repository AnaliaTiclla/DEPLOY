<div class="container p-4">
    <div class="mesas-list">
        <ng-container *ngFor="let mesa of mesas">
            <div class="mesa-item" (click)="seleccionarMesa(mesa)"
                 [ngClass]="{'estado-libre': mesa.estado === 'Libre',
                             'estado-ocupada': mesa.estado === 'Ocupada',
                             'estado-pendiente': mesa.estado === 'Pendiente'}">
                <h2 class="mesa-titulo">Mesa {{ mesa.numero }}</h2>
                <p>{{ mesa.estado }}</p>
                <hr>
            </div>
        </ng-container>
    </div>

    <div class="modal" *ngIf="mesaSeleccionada">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Mesa {{ mesaSeleccionada.numero }}</h2>
                <button class="btn-cerrar" (click)="cerrarModal()">×</button>
            </div>

            <div class="categorias-tabs">
                <button *ngFor="let cat of categorias"
                        [class.activo]="categoriaActual === cat"
                        (click)="categoriaActual = cat">
                    {{ cat }}
                </button>
            </div>

            <div class="productos-grid">
                <div *ngFor="let producto of getProductosPorCategoria()"
                     class="producto-item"
                     (click)="agregarAlPedido(producto)">
                    <span>{{ producto.nombre }}</span>
                    <span>S/. {{ producto.precio.toFixed(2) }}</span>
                </div>
            </div>

            <div class="pedido-actual">
                <h3>Pedido Actual</h3>
                <div *ngIf="pedidoActual.length === 0" class="mensaje-vacio">
                    No hay items en el pedido
                </div>
                <ng-container *ngIf="pedidoActual.length > 0">
                    <div *ngFor="let item of pedidoActual" class="pedido-item">
                        <div class="item-info">
                            <span>{{ item.nombre }}</span>
                            <span class="cantidad">x{{ item.cantidad }}</span>
                        </div>
                        <div class="item-acciones">
                            <span>S/. {{ (item.precio * item.cantidad).toFixed(2) }}</span>
                            <button (click)="eliminarItem(item)">×</button>
                        </div>
                    </div>
                    <div class="pedido-total">
                        <span>Total:</span>
                        <span>S/. {{ calcularTotal().toFixed(2) }}</span>
                    </div>
                    <div class="pedido-acciones">
                        <button class="btn-enviar" [disabled]="!pedidoPagado" (click)="enviarPedido()">
                            Enviar a Cocina
                        </button>
                        <button class="btn-cobrar" (click)="mostrarPago()">
                            Cobrar
                        </button>
                    </div>
                </ng-container>
            </div>

            <div *ngIf="mostrarCobro" class="pago-seccion">
                <h3>Realizar Pago</h3>
                <label for="tipoComprobante">Tipo de Comprobante:</label>
                <select [(ngModel)]="tipoComprobante">
                    <option value="Boleta">Boleta</option>
                    <option value="Factura">Factura</option>
                    <option value="Ticket">Ticket</option>
                </select>

                <div *ngIf="tipoComprobante === 'Boleta' || tipoComprobante === 'Factura'">
                    <label for="dniRuc">DNI o RUC:</label>
                    <input type="text" [(ngModel)]="dniRuc" placeholder="Ingrese DNI o RUC">
                </div>

                <button class="btn-confirmar-pago" (click)="confirmarPago()">Confirmar Pago</button>
            </div>
        </div>
    </div>
</div>
